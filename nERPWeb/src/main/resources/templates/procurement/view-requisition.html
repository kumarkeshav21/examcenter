<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/master}">
<head>
<style type="text/css">
.highcharts-exporting-group {
	display: none;
}

.slidebox {
	padding: 14px;
	margin-top: 0px;
	margin: 0px 10px;
}

/* .form-group label {
	font-size: 12px;
	position: relative;
	top: 4px;
} */
.holdCls {
	background-color: rgb(0, 143, 0);
}

.bg_white {
	background: #ffffff !important;
}

input[type="date"]::-webkit-input-placeholder {
	visibility: hidden !important;
}

.modal-body table td input[type=checkbox] {
    width: 0px;
    margin-right: 16px;
    position: relative;
    top: 0px;
     float: none; 
}

.firstnode {
	color: #929292;
	border-top: 1px solid transparent !important;
	border-left: 1px solid transparent !important;
	border-bottom: 1px solid transparent !important;
	width: 320px;
	font-size: 12px;
    font-weight: 100;
}

.simple-tree-table-closed .simple-tree-table-icon:after {
	content: "\f105" !important;
	font-family: 'FontAwesome';
	color: black;
	display: inline-block;
	margin-right: 6px;
	transform: rotate(90deg);
}

.simple-tree-table-opened .simple-tree-table-icon:after {
	content: "\f105" !important;
	font-family: 'FontAwesome';
	color: black;
	display: inline-block;
	margin-right: 6px;
}

.simple-tree-table-icon {
	display: inline-block;
	width: 1.5em;
	line-height: 1.5em;
	margin: 0.1em;
	background-color: transparent;
	text-align: center;
	cursor: pointer;
}
</style>
<script type="text/javascript">
	function openNav() {
		document.getElementById("mySidenav").style.cssText = "width: 350px; position: absolute; right:-30px; overflow: hidden; height:auto; top:260px;";

		document.getElementById("main_content").style.width = "72%";
		$('#cancelBtn').attr('disabled', true);
		$('#saveReq').attr('disabled', true);

	}

	function closeNav() {
		document.getElementById("mySidenav").style.width = "0";
		document.getElementById("main_content").style.width = "100%";
		$('#cancelBtn').attr('disabled', false);
		$('#saveReq').attr('disabled', false);
		$("#sku").html('');
		$("#skuEditId").html('');
		$("#brandId").html('');
		$("#itemId").val('');
		$("#itemName").html('');
		$("#locationId").val(null);
		$("#costCenterId").val(null);
		$("#quantity").val('');
		$("#uom").val(null);
		$("#estimatedPrice").val('');
		$("#totalEstPrc").val('');
		$("#lastPurchaseUnitPrice").val('');
		$("#lastPurchaseTotalPrice").val('');
		$("#search").val('');
	}

	var count1 = 0;
	function allCheck1() {
		count1++;

		if (count1 == 1) {
			$('.checkCls1').prop("checked", true);
		} else {
			count1 = 0;
			$('.checkCls1').prop("checked", false);
		}
	}

	function cancelBar() {
		var id = document.getElementById("closeKey");
		id.style.display = "block";
		if ($('#searchBar').val() == null || $('#searchBar').val() == "") {
			id.style.display = "none";
		}
	}
 
</script>

<script type="text/javascript">
	$(document).ready(function() {
		//changeOpt();
		$('.loader').show();
        $("body").addClass("overlay");
		agGrid.simpleHttpRequest({
			url : 'view-requisition-trough-ajax'
		}).then(function(data) {
			var len = data.length;
			$('#totalReq').find('span').html(len);
			gridOptions.api.setRowData(data);
			$('.loader').hide();
            $("body").removeClass("overlay");
		});

		var ld = localStorage.getItem('productData');
		var data = JSON.parse(ld);
		if (data) {
			$("#myGrid").hide();
			$("#reqTable").hide();
			$(".btn-hs").hide();
			$("#demo").show();
			$('#dltProduct').attr('disabled', true);
			$('#addProduct').attr('disabled', true);

			productOptions.api.setRowData(data);

			localStorage.setItem('productData', null);
		}

		$("#statusDiv").hide();
		$('#reqDltBtn').attr('disabled', true);
		$('#reqCopyBtn').attr('disabled', true);
		$('#reqAppvBtn').attr('disabled', true);

		$('.collapse').on('show.bs.collapse', function() {
			$(this).siblings('.panel-heading').addClass('active');
		});

		$('.collapse').on('hide.bs.collapse', function() {
			$(this).siblings('.panel-heading').removeClass('active');
		});
		$("#newBtn").click(function() {
			$("#myGrid").hide();
			$("#reqTable").hide();
			$(".btn-hs").hide();
			$("#demo").show();
		})

		$("#cancelBtn").click(function() {
			$('.loader').show();
			$("body").addClass("overlay");
			$("#reqTable").show();
			$(".btn-hs").show();
			$("#myGrid").show();
			$("#demo").hide();
			agGrid.simpleHttpRequest({
				url : 'view-requisition-trough-ajax'
			}).then(function(data) {
				var len = data.length;
				$('#totalReq').find('span').html(len);
				gridOptions.api.setRowData(data);
			});
			$("#desc").val('');
			$("#reqType").val('');
			$("#reqPrior").val('');
			$("#receiveDate").val('');
			$("#receiveDateCalendar").val('');
			$("#isHold").val('1');
			$("#reqId").val('');
			$("#source").html('');
			$("#rfqId").val('');
			$("#reqHeadId").html('');
			$("#createdDate").append('');
			$("#activeDate").append('');
			$("#completeDate").html('');
			$("#onHoldDate").html('');
			$("#sku").html('');
			$("#skuEditId").html('');
			$("#brandId").html('');
			$("#itemId").val('');
			$("#itemName").html('');
			$("#locationId").val(null);
			$("#costCenterId").val(null);
			$("#quantity").val('');
			$("#uom").val(null);
			$("#estimatedPrice").val('');
			$("#totalEstPrc").val('');
			$("#lastPurchaseUnitPrice").val('');
			$("#lastPurchaseTotalPrice").val('');
			$("#search").val('');
			$("#createdDate").empty();
			$("#activeDate").empty();
			$("#completeDate").empty();
			$("#onHoldDate").empty();
			headerStatus();
			$('.loader').hide();
			$("body").removeClass("overlay");
		});

		$("#quarter").click(function() {
			$("#myTbl").hide();
			$(".btn-hs").hide();
			$("#demo").show();
		})
		var dateFormat = localStorage.getItem("dateFormat");
		$("#receiveDateCalendar").datetimepicker({
			format : dateFormat,
			closeOnDateSelect : true,
			timepicker : false,
		}).on("change", function() {
			$('#receiveDate').val($(this).val());
		})
		
		$('#receiveDate').blur(function(){
			$("#receiveDateCalendar").val($(this).val());
		})

		$("#browseBtn").click(function() {
			$("#myModal").modal('show');
			getCategoryList();
		})

	});

	$("input[class='myCheckbox']").click(function() {
		if ($("#formID input:checkbox:checked").length > 0) {
			$(".checkSubmit").addClass('active');
		} else {
			$(".checkSubmit").removeClass('active');
		}
	});

	function cancelBar() {
		var id = document.getElementById("closeKey");
		id.style.display = "block";
		if ($('#quickFilter').val() == null || $('#quickFilter').val() == "") {
			id.style.display = "none";
		}
	}
</script>

<script>
	var columnDefs = [
			{
				headerCheckboxSelection : true,
				headerCheckboxSelectionFilteredOnly : true,
				checkboxSelection : true,
				sortable : false,
				filter : false,
				resizable : true,
				width : 20,
			},
			{
				headerName : "Requisition Id",
				field : "reqId",
				cellRenderer : function(params) {
					return '<a onclick=editRequisition("' + params.data.reqId
							+ '") href="javascript:void(0)">'
							+ params.data.reqId + '</a>';
				}

			}, {
				headerName : "Description",
				field : "desc"
			}, {
				headerName : "Type",
				field : "reqType"
			}, {
				headerName : "Priority",
				field : "reqPrior"

			}, {
				headerName : "Receive By Date",
				field : "receiveDate",
				cellStyle : {
					textAlign : 'center'
				}

			}, {
				headerName : "Status",
				field : "approveStatus",
				cellStyle : {
					textAlign : 'center'
				}

			}, {
				headerName : "Created By",
				field : "createdBy"

			}, {
				headerName : "Created Date",
				field : "createdOn",
				cellStyle : {
					textAlign : 'center'
				}

			} ];

	// for product table

	var productDefs = [
			{
				headerCheckboxSelection : true,
				headerCheckboxSelectionFilteredOnly : true,
				checkboxSelection : true,
				sortable : false,
				filter : false,
				resizable : true,
				width : 20
			},
			{
				headerName : "SKU",
				field : "sku",
				cellRenderer : function(params) {
					return '<a onclick=editProduct("' + params.data.sku
							+ '") href="javascript:void(0)">' + params.data.sku
							+ '</a>';
				}
			}, {
				headerName : "Name",
				field : "itemName"

			}, {
				headerName : "itemId",
				field : "itemId",
				hide : "true"
			}, {
				headerName : "Brand",
				field : "brandName"
			}, {
				headerName : "BrandId",
				field : "brand",
				hide : "true"
			}, {
				headerName : "Location",
				field : "location"

			}, {
				headerName : "locationId",
				field : "locationId",
				hide : "true"

			}, {
				headerName : "Cost Center",
				field : "costCenter"

			}, {
				headerName : "costCenterId",
				field : "costCenterId",
				hide : "true"
			}, {
				headerName : "Quantity",
				field : "qty",
				type : 'rightAligned',
				valueFormatter : currencyFormatter

			}, {
				headerName : "UOM",
				field : "uom"

			}, {
				headerName : "uomId",
				field : "uomId",
				hide : "true"
			}, {
				headerName : "Estimated Price",
				field : "estimatedPrice",
				type : 'rightAligned',
				valueFormatter : currencyFormatter

			}, {
				headerName : "Last Purchase Price",
				field : "lastPurchaseUnitPrice",
				type : 'rightAligned',
				valueFormatter : currencyFormatter

			}, {
				headerName : "Created Date",
				field : "createdOn",
				cellStyle : {
					textAlign : 'center'
				}

			} ];

	var activityDefs = [ {
		headerCheckboxSelection : true,
		headerCheckboxSelectionFilteredOnly : true,
		checkboxSelection : true,
		sortable : false,
		filter : false,
		resizable : true,
		width : 20
	}, {
		headerName : "Activity Name",
		field : "operationName"
	}, {
		headerName : "User Name",
		field : "operationBy"
	}, {
		headerName : "Created Date",
		field : "operationOn",
		cellStyle : {
			textAlign : 'center'
		}

	} ];

	// let the grid know which columns and what data to use product table
	var activityOptions = {
		columnDefs : activityDefs,
		rowSelection : 'multiple',
		groupSelectsChildren : true,
		suppressRowClickSelection : true,
		suppressAggFuncInHeader : true,
		defaultColDef : {
			sortable : true,
			filter : true,
			resizable : true,
			width : 353
		}

	};

	// let the grid know which columns and what data to use activity table
	var productOptions = {
		columnDefs : productDefs,
		rowSelection : 'multiple',
		groupSelectsChildren : true,
		suppressRowClickSelection : true,
		suppressAggFuncInHeader : true,
		defaultColDef : {
			sortable : true,
			filter : true,
			resizable : true,
			width : 153
		},
		getRowNodeId : function(data) {
			return data.sku;
		}

	};

	// let the grid know which columns and what data to use
	var gridOptions = {
		columnDefs : columnDefs,
		rowSelection : 'multiple',
		groupSelectsChildren : true,
		suppressRowClickSelection : true,
		suppressAggFuncInHeader : true,
		defaultColDef : {
			sortable : true,
			filter : true,
			resizable : true,
			width : 153
		},
		onSelectionChanged : onSelectionChanged,

	};

	// setup the grid after the page has finished loading
	document.addEventListener('DOMContentLoaded', function() {
		var gridDiv = document.querySelector('#myGrid');
		new agGrid.Grid(gridDiv, gridOptions);

		var gridDiv = document.querySelector('#product');
		new agGrid.Grid(gridDiv, productOptions);

		var gridDiv = document.querySelector('#activity');
		new agGrid.Grid(gridDiv, activityOptions);

	});

	function resetState() {
		gridOptions.columnApi.resetColumnState();

	}

	function onQuickFilterChanged() {
		gridOptions.api
				.setQuickFilter(document.getElementById('quickFilter').value);
	}

	function onSelectionChanged() {
		var selectedRows = gridOptions.api.getSelectedRows();
		var rowCount = 0;
		selectedRows.forEach(function(selectedRow, index) {
			rowCount = rowCount + 1;
		});

		if (rowCount > 0) {
			$('#reqDltBtn').attr('disabled', false);
			$('#reqCopyBtn').attr('disabled', false);
			$('#reqAppvBtn').attr('disabled', false);
		} else {
			$('#reqDltBtn').attr('disabled', true);
			$('#reqCopyBtn').attr('disabled', true);
			$('#reqAppvBtn').attr('disabled', true);
		}

	}
	function switchPage() {

		var selectedRows = gridOptions.api.getSelectedRows();
		var selectedRowsString = '';
		selectedRows.forEach(function(selectedRow, index) {
			if (index > 0) {
				selectedRowsString += ',';
			}
			selectedRowsString += selectedRow.itemId;
		});
		$('.loader').show();
		$("body").addClass("overlay");
		// for product table
		agGrid.simpleHttpRequest({
			url : 'view-requisition-item-trough-ajax?id=' + selectedRowsString
		}).then(function(data) {
			productOptions.api.setRowData(data);
		});
		agGrid.simpleHttpRequest({
			url : 'view-requisition-activity-log?id=' + selectedRowsString
		}).then(function(data) {
			activityOptions.api.setRowData(data);
		}); 
		
		if ($("#reqHeadId").html() != null  && $("#reqHeadId").html() != '') { 
			$('#createRfq').attr('disabled', false);
		} else {
			$('#createRfq').attr('disabled', true);
		}
		$('.loader').hide();
		$("body").removeClass("overlay");
	}
	// for edit indivisual product
	function editProduct(prodId) {

		var reqId = $("#reqHeadId").html();
		var rowNode = productOptions.api.getRowNode(prodId);

		$("#sku").html(prodId);
		$("#skuEditId").html(prodId);
		$("#brandId").val(rowNode.data.brand);
		$("#brandName").html(rowNode.data.brandName);
		$("#itemId").val(rowNode.data.itemId);
		$("#itemName").html(rowNode.data.itemName);
		$("#locationId").val(rowNode.data.locationId);
		$("#costCenterId").val(rowNode.data.costCenterId);
		$("#productEdit").val(prodId);
		$("#quantity").val(addCommas(rowNode.data.qty));
		$("#uom").val(rowNode.data.uomId);
		$("#estimatedPrice").val(addCommas(rowNode.data.estimatedPrice));
		$("#totalEstPrc").val(addCommas(rowNode.data.estimatedTotalPrice));
		$("#lastPurchaseUnitPrice").val(addCommas(rowNode.data.lastPurchaseUnitPrice));
		$("#lastPurchaseTotalPrice").val(addCommas(rowNode.data.lastPurchaseTotalPrice));
		$("#search").val(rowNode.data.itemName);

		openNav();

	}

	function editRequisition(reqId) {
		$("#myGrid").hide();
		$("#reqTable").hide();
		$(".btn-hs").hide();
		$("#demo").show();
		$('.loader').show();
		$("body").addClass("overlay");
		agGrid.simpleHttpRequest({
			url : 'view-requisition-item-trough-ajax?id=' + reqId
		}).then(function(data) {
			$("#desc").val(data[0].desc);
			$("#reqType").val(data[0].reqType);
			$("#reqPrior").val(data[0].reqPrior);
			$("#receiveDate").val(data[0].receiveDate);
			$("#receiveDate").val(data[0].receiveDate);
			$("#receiveDateCalendar").val(data[0].receiveDate);
			$("#isHold").val(data[0].holdStatus);
			$("#reqId").val(data[0].reqId);
			$("#reqHeadId").html(data[0].reqId);
			$("#createdDate").empty();
			$("#createdDate").append(data[0].createdOn);
			$("#activeDate").empty();
			$("#activeDate").append(data[0].activeDate);
			$("#completeDate").empty();
			$("#completeDate").html(data[0].completeDate);
			$("#onHoldDate").empty();
			$("#onHoldDate").html(data[0].onHoldDate);
			
			productOptions.api.setRowData(data);
			
			if(data[0].isProductExist == "0") {
				$("#isProductExist").prop("checked",false);
			} else {
				$("#isProductExist").prop("checked",true);
				var dataset = [];
				productOptions.api.setRowData(dataset);
			}
			
			if (data[0].holdStatus === '1') {
				$("#putOnHold").removeClass('holdCls');
			} else if (data[0].holdStatus === '4') {
				$("#putOnHold").addClass('holdCls');
			}
			//putOnHold();
			headerStatus();
			productExistMethod();
			$('.loader').hide();
			$("body").removeClass("overlay");
		});

		agGrid.simpleHttpRequest({
			url : 'view-requisition-activity-log?id=' + reqId
		}).then(function(data) {
			activityOptions.api.setRowData(data);
		}); 
	}
	// for copy all elements
	function copy() {
		var selectedRows = gridOptions.api.getSelectedRows();
		var selectedRowsString = '';
		var count = 0;
		selectedRows
				.forEach(function(selectedRow, index) {
					if (count > 0) {
						$("#alert").modal('show');
						document.getElementById("textId").innerHTML = "Please Select Only one Record For Copy !";
					} else {
						selectedRowsString += selectedRow.reqId;
					}
					count++;
				});

		if (selectedRowsString) {
			$("#myGrid").hide();
			$("#reqTable").hide();
			$(".btn-hs").hide();
			$("#demo").show();
			$('.loader').show();
			$("body").addClass("overlay");
			agGrid.simpleHttpRequest(
					{
						url : 'view-requisition-item-trough-ajax?id='
								+ selectedRowsString
					}).then(function(data) {
				$("#desc").val(data[0].desc);
				$("#reqType").val(data[0].reqType);
				$("#reqPrior").val(data[0].reqPrior);
				$("#receiveDate").val(data[0].receiveDate);
				$("#receiveDateCalendar").val(data[0].receiveDate);
				$("#isHold").val(data[0].holdStatus);
				$("#reqId").val(null);
				$("#reqHeadId").html(data[0].reqId);
				//$("#reqId").val(data[0].reqId);
				if (data[0].holdStatus == '1') {
					$("#putOnHold").removeClass('holdCls');
				} else if (data[0].holdStatus == '4') {
					$("#putOnHold").addClass('holdCls');
				}
				for (var i = 0; i < data.length; i++) {
					data[i].reqId = '';
				}
				productOptions.api.setRowData(data);
			});

			agGrid.simpleHttpRequest({
				url : 'view-requisition-activity-log?id=' + selectedRowsString
			}).then(function(data) {
				activityOptions.api.setRowData(data);
			}); 
			$('.loader').hide();
			$("body").removeClass("overlay");
		} else {
			$('.loader').hide();
			$("body").removeClass("overlay");

			$("#alert").modal('show');
			document.getElementById("textId").innerHTML = "Please Select Atleast one Record !";
		}

	}

	function deleteFun() {
		$('#delete').modal('show');
	}
	function deleteProduct() {
		$('#deleteProduct').modal('show');
	}
	function deleteProductIndConfirm() {
		$('#deleteProductInd').modal('show');
	}
	// deleting ind product
	/* function deleteProductInd() {
		var productEdit = $("#productEdit").val();
		if (productEdit) {
			productOptions.api.applyTransaction({
				remove : [ productOptions.api.getRowNode(productEdit).data ]
			});
			closeNav();
			$("#sku").html('');
			$("#skuEditId").html('');
			$("#brandId").val('');
			$("#brandName").html('');
			$("#itemId").html('');
			$("#itemName").html('');
			$("#locationId").val('');
			$("#quantity").val('');
			$("#uom").val('');
			$("#estimatedPrice").val('');
			$("#totalEstPrc").val('');
			$("#lastPurchaseUnitPrice").val('');
			$("#lastPurchaseTotalPrice").val('');
			$("#search").val('');
			$("#productEdit").val(null);
		}

	} */
	// delete requisition 
	function deleteOnclick() {
		var selectedRows = gridOptions.api.getSelectedRows();
		var selectedRowsString = '';
		selectedRows.forEach(function(selectedRow, index) {
			if (index > 0) {
				selectedRowsString += ',';
			}
			selectedRowsString += selectedRow.reqId;
		});
		if (selectedRowsString) {
			var item = {};
			item.moduleId = localStorage.getItem('module');
			item.componentId = localStorage.getItem('function');
			item.subComponentId = localStorage.getItem('activity');
			item.reqId = selectedRowsString;
			$('.loader').show();
			$("body").addClass("overlay");
			$.ajax({
				type : "POST",
				url : "view-requisition-delete-th-ajax",
				dataType : "json",
				contentType : "application/json",
				data : JSON.stringify(item),
				success : function(response) {
					$('.loader').hide();
					if (response.message == "Success") {

						agGrid.simpleHttpRequest({
							url : 'view-requisition-trough-ajax'
						}).then(function(data) {
							var len = data.length;
							$('#totalReq').find('span').html(len);

							gridOptions.api.setRowData(data);
						});
						$('.loader').hide();
						$("body").addClass("overlay");
					} else {
						swal({
							title : response.code,
							text : response.message,
							type : "warning"
						})
					}
				},
				error : function(data) {
					console.log(data)
				}
			})
		} else {
			$("#alert").modal('show');
			document.getElementById("textId").innerHTML = "Please Select Atleast one Record !";
		}

	}
	// delete selected record from ag grid
	function deleteProductOnclick() {
		var selectedRows = productOptions.api.getSelectedRows();
		productOptions.api.applyTransaction({
			remove : selectedRows
		});
		cancelModalProductBtn();

	}

	function cancelModalBtn() {
		$("#deleteModalBtn").removeAttr("disabled");
	}
	//for closeing modal box for dlt  product
	function cancelModalProductBtn() {
		$("#deleteModalBtn").removeAttr("disabled");
		$('#deleteProduct').modal('hide');
	}
	//for closeing modal box for dlt ind product
	function cancelModalBtnDPI() {
		$('#deleteProductInd').modal('hide');
	}
	//for approve requisition
	function approve() {
		var selectedRows = gridOptions.api.getSelectedRows();
		var selectedRowsString = '';
		selectedRows.forEach(function(selectedRow, index) {
			if (index > 0) {
				selectedRowsString += ',';
			}
			selectedRowsString += selectedRow.reqId;
		});
		if (selectedRowsString) {
			var item = {};
			item.moduleId = localStorage.getItem('module');
			item.componentId = localStorage.getItem('function');
			item.subComponentId = localStorage.getItem('activity');
			item.reqId = selectedRowsString;
			$('.loader').show();
			$("body").addClass("overlay");
			$.ajax({
				type : "POST",
				url : "view-requisition-approve-th-ajax",
				dataType : "json",
				contentType : "application/json",
				data : JSON.stringify(item),
				success : function(response) {
					$('.loader').hide();
					$("body").removeClass("overlay");
					if (response.message == "Success") {
						//window.location.href = "/inventory/view-requisition";
						// for refreshing grid data
						agGrid.simpleHttpRequest({
							url : 'view-requisition-trough-ajax'
						}).then(function(data) {
							var len = data.length;
							$('#totalReq').find('span').html(len);

							gridOptions.api.setRowData(data);
						});
					} else {
						swal({
							title : response.code,
							text : response.message,
							type : "warning"
						})
					}
				},
				error : function(data) {
					console.log(data)
				}
			})

		} else {
			$("#alert").modal('show');
			document.getElementById("textId").innerHTML = "Please Select Atleast one Record !";
		}
	}
</script>
<script type="text/javascript">
//for stock graph  report 
function stockReport() {
    $('.loader').show();
    var selectedRows = productOptions.api.getSelectedRows();
    var selectedRowsString = '';
    selectedRows.forEach(function(selectedRow, index) {
        if (index > 0) {
            selectedRowsString += ',';
        }
        selectedRowsString += selectedRow.itemId;
    });

    if (selectedRowsString) {

        $('#lineGraph').modal('show');
        $.ajax({
            type: "GET",
            url: "/inventory/view-stock-daily-report?id=" +
                selectedRowsString,
            dataType: 'json',
            data: selectedRowsString,
            success: function(response) {
                $('.loader').hide();
                if (response.message == "success") {
                    $("#graphTable").empty();
                    lineGrapg(response.body.dataList,
                        response.body.dates, 'Stock');
                    var tableHeader = '<tr>';
                    for (var i = 0; i < response.body.dates.length; i++) {

                        tableHeader = tableHeader + '<td>' +
                            response.body.dates[i] + '</td>';
                    }
                    tableHeader = tableHeader + '</tr>';
                    $("#graphTable").append(tableHeader);

                    for (var i = 0; i < response.body.dataList.length; i++) {
                        var tableBody = '<tr><td>' +
                            response.body.dataList[i].name +
                            '</td>';
                        for (var j = 0; j < response.body.dataList[i].data.length; j++) {
                            tableBody = tableBody +
                                '<td>' +
                                response.body.dataList[i].data[j] +
                                '</td>';
                        }
                        tableBody = tableBody + '</tr>';
                        $("#graphTable").append(tableBody);
                    }

                }
            },
            error: function(data) {
                console.log(data);
                $('.loader').hide();
            }
        })
    } else {
        swal("Please Select At least One Product.");
    }

}
// get excel report
function getExcelReport() {
    var selectedRows = productOptions.api.getSelectedRows();
    var selectedRowsString = '';
    selectedRows.forEach(function(selectedRow, index) {
        if (index > 0) {
            selectedRowsString += ',';
        }
        selectedRowsString += selectedRow.itemId;
    });

    window.location.href = "/inventory/view-stock-daily-report-excel?id=" +
        selectedRowsString;
}
// for save only side bar data
function saveTableData() {
    var item = {};
    var valid = true;

    var valid = validSideBarData();
    if (valid) {
        item.sku = $("#sku").html();
        item.brand = $("#brandId").val();
        item.brandName = $("#brandName").html();
        item.itemId = $("#itemId").val();
        item.itemName = $("#itemName").html();
        item.locationId = $("#locationId").val();
        item.location = $("#locationId").find('option:selected').text();
        item.costCenterId = $("#costCenterId").val();
        item.costCenter = $("#costCenterId").find('option:selected').text();
        item.qty = removeCommas($("#quantity").val());
        item.uomId = $("#uom").val();
        item.uom = $("#uom").find('option:selected').text();
        item.estimatedPrice = removeCommas($("#estimatedPrice").val());
        item.estimatedTotalPrice = removeCommas($("#totalEstPrc").val());
        item.lastPurchaseUnitPrice = removeCommas($("#lastPurchaseUnitPrice").val());
        item.lastPurchaseTotalPrice = removeCommas($("#lastPurchaseTotalPrice").val());
        var productEdit = $("#productEdit").val();
        var datas = [];

        if (productEdit) {
            var rowNode = productOptions.api.getRowNode(productEdit);
            rowNode.setData(item);
        } else {
            productOptions.api.forEachNode(function(rowNode, index) {
                datas.push(rowNode.data);
            });
            datas.push(item)
            productOptions.api.setRowData(datas);
        }
        closeNav();
        $("#sku").html('');
        $("#skuEditId").html('');
        $("#brandId").val('');
        $("#brandName").html('');
        $("#itemId").html('');
        $("#itemName").html('');
        $("#locationId").val('');
        $("#quantity").val('');
        $("#uom").val('');
        $("#estimatedPrice").val('');
        $("#totalEstPrc").val('');
        $("#lastPurchaseUnitPrice").val('');
        $("#lastPurchaseTotalPrice").val('');
        $("#search").val('');
        $("#productEdit").val(null);
    }

}

function saveData() {
    if (validFormData() && validProductData()) {
        var datas = [];
        $('.loader').show();
        $("body").addClass("overlay");
        var isProduct = $("input[name='isProductExist']:checked").val();
        if (isProduct == null || isProduct == "") {
            isProduct = 0;
        }
        if (productOptions.api.getDisplayedRowCount() > 0) {
            productOptions.api.forEachNode(function(rowNode, index) {
                var item = rowNode.data;
                item.isProductExist = isProduct;
                item.desc = $("#desc").val();
                item.reqType = $("#reqType").val();
                item.reqPrior = $("#reqPrior").val();
                item.receiveDate = $("#receiveDate").val();
                item.holdStatus = $("#isHold").val();
                item.reqId = $("#reqId").val();
                item.moduleId = localStorage.getItem('module');
                item.componentId = localStorage.getItem('function');
                item.subComponentId = localStorage.getItem('activity');
                item.qty = item.qty;
                item.estimatedPrice = item.estimatedPrice;
                item.lastPurchaseUnitPrice = item.lastPurchaseUnitPrice;
                datas.push(item);
            });
        } else {
            var item = {};
            item.isProductExist = isProduct;
            item.desc = $("#desc").val();
            item.reqType = $("#reqType").val();
            item.reqPrior = $("#reqPrior").val();
            item.receiveDate = $("#receiveDate").val();
            item.holdStatus = $("#isHold").val();
            item.reqId = $("#reqId").val();
            item.moduleId = localStorage.getItem('module');
            item.componentId = localStorage.getItem('function');
            item.subComponentId = localStorage.getItem('activity');
            datas.push(item);
        }

        console.log(datas)
        saveRequisition(datas);
    }

}

function saveRequisition(datas) {

    $.ajax({
        type: "POST",
        url: "view-requisition-save-th-ajax",
        dataType: "json",
        contentType: "application/json",
        data: JSON.stringify(datas),
        success: function(response) {
            $('.loader').hide();
            $("body").removeClass("overlay");
            if (response.message == "Success") {
                $("#messageParagraph").text(
                    "Data Saved Successfully");
                $("#msgOkModal").removeClass("btn3");
                $("#msgOkModal").addClass("btn1");
                $("#msgModal").modal('show');
                $("#desc").val(response.body[0].desc);
                $("#reqType").val(response.body[0].reqType);
                $("#reqPrior").val(response.body[0].reqPrior);
                $("#receiveDate").val(response.body[0].receiveDate);
                $("#receiveDateCalendar").val(
                    response.body[0].receiveDate);
                $("#isHold").val(response.body[0].holdStatus);
                $("#reqId").val(response.body[0].reqId);
                $("#reqHeadId").html(response.body[0].reqId);
                $("#createdDate").empty();
                $("#createdDate")
                    .append(response.body[0].createdOn);
                $("#activeDate").empty();
                $("#activeDate")
                    .append(response.body[0].activeDate);
                $("#completeDate").empty();
                $("#completeDate").html(
                    response.body[0].completeDate);
                $("#onHoldDate").empty();
                $("#onHoldDate").html(response.body[0].onHoldDate);

                productOptions.api.setRowData(response.body);

                if (response.body[0].isProductExist == "0") {
                    $("#isProductExist").prop("checked", false);
                } else {
                    $("#isProductExist").prop("checked", true);
                    var dataset = [];
                    productOptions.api.setRowData(dataset);
                }

                agGrid.simpleHttpRequest({
                    url: 'view-requisition-activity-log?id=' +
                        response.body[0].reqId
                }).then(function(data) {
                    activityOptions.api.setRowData(data);
                });
                if (response.body[0].holdStatus == '1') {
                    $("#putOnHold").removeClass('holdCls');
                } else if (response.body[0].holdStatus == '4') {
                    $("#putOnHold").addClass('holdCls');
                }
                //putOnHold();
                headerStatus();
                productExistMethod();
            } else {
                $('.loader').hide();
                $("body").removeClass("overlay");
            }
        },
        error: function(data) {
            console.log(data);
            $('.loader').hide();
            $("body").removeClass("overlay");
        }
    }) //ajax ends

}

function cancelBar() {
    var id = document.getElementById("closeKey");
    id.style.display = "block";
    if ($('#quickFilter').val() == null || $('#quickFilter').val() == "") {
        id.style.display = "none";
    }
}

function getProductList() {
    var search = $("#search").val();
    if (search) {

        $.ajax({
            type: "POST",
            url: "view-requisition-get-product-list",
            dataType: 'json',
            contentType: 'application/json',
            data: search,
            success: function(response) {
                if (response.message == "success") {

                    if (response.body.length != 0) {
                        $("#search").css("background", "#FFF");
                        var content = '<ul id="autocomplete-list1" style="margin-left:-40px; font-weight:100; font-size:14px; color:#ccc;">';
                        for (var i = 0; i < response.body.length; i++) {
                            content += '<li class="autocompletedata cp" onClick="selectAutocompleteValue1(\'' +
                                response.body[i].itemId +
                                '\',\'' +
                                response.body[i].itemName +
                                '\',\'' +
                                response.body[i].sku +
                                '\',\'' +
                                response.body[i].brandName +
                                '\',\'' +
                                response.body[i].brand +
                                '\',\'' +
                                response.body[i].itemCategoryId +
                                '\',\'' +
                                response.body[i].itemCategoryName +
                                '\')">' +
                                response.body[i].itemName +
                                '(' +
                                response.body[i].sku +
                                ')' +
                                '(' +
                                response.body[i].brandName +
                                ')' + '</li>';
                        }
                        content += '</ul>';
                        $("#suggesstion-box1_").show();
                        $("#suggesstion-box1_").html(content);

                    } else {
                        $("#search").css("background", "#FFF");
                        var content = '<ul id="autocomplete-list1">';
                        content += '<li onClick="selectAutocompleteValue()">' +
                            "No Data Found" + '</li>';
                        content += '</ul>';
                        $("#suggesstion-box1_").show();
                        $("#suggesstion-box1_").html(content);
                    }
                }
            },
            error: function(data) {
                console.log(data);
            }
        })
    }
}

function selectAutocompleteValue1(key, name, sku, brandName, brand,
    prodcatId, prodCatName) {

    if (key) {
        $("#itemName").html(name);
        $("#itemId").val(key);
        $("#brandName").html(brandName);
        $("#brandId").val(brand);
        $("#prodCatId").val(prodcatId);
        $("#prodCatName").val(prodCatName);
        $("#sku").html(sku);
        $("#search").val(name)
        $("#search").attr('data-procat', key);
        $("#suggesstion-box1_").hide();
        //checkForDuplicate(key,counter);

    } else {

        $("#itemName").html("");
        $("#itemId").val("");
        $("#brandId").html("");
        $("#brandId").val("");
        $("#sku").html("");
        $("#prodCatId").val('');
        $("#prodCatName").val('');
        $("#search").val("");
        $("#search").attr('data-procat', "");
        $("#suggesstion-box1_").hide();

    }
}

function selectAutocompleteValue() {
    $("#itemName").html("");
    $("#itemId").val("");
    $("#brandId").val("");
    $("#brandName").html("");
    $("#sku").html("");
    $("#search").val("");
    $("#search").attr('data-procat', "");
    $("#suggesstion-box1_").hide();

}

function putOnHold() {
    var isHold = $("#isHold").val();
    if (isHold == '1') {
        $("#isHold").val('4');
        $("#putOnHold").removeClass('holdCls');
    } else if (isHold == '4') {
        $("#isHold").val('1');
        $("#putOnHold").addClass('holdCls');
    }
}

function viewRFQ() {
    sessionStorage.setItem('activity', 'ACT0021');
    agGrid.simpleHttpRequest({
        url: 'view-requisition-item-trough-ajax?id=' + $("#reqId").val()
    }).then(function(data) {
        localStorage.setItem('ReqData', JSON.stringify(data));
        productOptions.api.setRowData(data);
    });
    window.location.href = "/inventory/view-quatation";
}

function headerStatus() {
    $("#statusDiv").show();
    var createdDate = $("#createdDate").text();
    var activeDate = $("#activeDate").text();
    var completeDate = $("#completeDate").text();
    var onHoldDate = $("#onHoldDate").text();
    if (createdDate) {
        $('#createdDiv').addClass('green-box');
        $('#createdDiv').removeClass('grey-box');

    } else {
        $('#createdDiv').removeClass('green-box');
        $('#createdDiv').addClass('grey-box');
    }
    if (activeDate) {
        $('#activeDiv').addClass('green-box');
        $('#activeDiv').removeClass('grey-box');
    } else {
        $('#activeDiv').addClass('grey-box');
        $('#activeDiv').removeClass('green-box');
    }
    if (completeDate) {
        $('#completeDiv').addClass('green-box');
        $('#completeDiv').removeClass('grey-box');
        $('#dltProduct').attr('disabled', true);
        $('#addProduct').attr('disabled', true);
        $('#createRfq').attr('disabled', true);
        $('#saveReq').attr('disabled', true);
    } else {
        $('#completeDiv').removeClass('green-box');
        $('#completeDiv').addClass('grey-box');
        $('#dltProduct').attr('disabled', false);
        $('#addProduct').attr('disabled', false);
        //$('#createRfq').attr('disabled', false);
        $('#saveReq').attr('disabled', false);
        if ($("#reqHeadId").html() != null || $("#reqHeadId").html() != "") {
            $('#createRfq').attr('disabled', false);
        } else {
            $('#createRfq').attr('disabled', true);
        }
    }
    if (onHoldDate) {
        $('#onHoldDiv').addClass('green-box');
        $('#onHoldDiv').removeClass('grey-box');
    } else {
        $('#onHoldDiv').removeClass('green-box');
        $('#onHoldDiv').addClass('grey-box');
    }
}

function clearSearchData() {
    $("#search").val(null);
    $("#sku").html('');
    $("#brandName").html('');
    $("#brandId").val('');
    $("#itemId").html('');
    $("#itemName").html('');
}

function getCategoryList() {
    $("#productCategoryCBDiv").empty();
    $
        .ajax({
            type: "POST",
            url: "view-requisition-product-category-get-total-list",
            dataType: "json",
            contentType: "application/json",
            success: function(response) {
                if (response.message == "Success") {

                    if (response.body.length > 0) {

                        var c = 0;
                        $("#totalPCat").text(c);
                        for (var i = 0; i < response.body.length; i++) {

                            c = c + 1;

                            if (response.body[i].nodeCount > 0) {
                                var tbl = '<ul id="myUL_' + response.body[i].categoryId + '" data-field="1" class="level bg_white"><li id="li_' + response.body[i].categoryId + '"><span class="caret" value="0" id="spanA_' +
                                    response.body[i].categoryId +
                                    '" onclick=getRootLeafNodes("' +
                                    response.body[i].categoryId +
                                    '")></span> ' +
                                    '<span id="lbl_' + response.body[i].categoryId + '" class="leveltxt" level="' + response.body[i].catLevel + '">' +
                                    response.body[i].categoryName +
                                    '</span> ' +
                                    '<ul class="nested bg_white" id="ul_' + response.body[i].categoryId + '" data-field="0"></ul>' +
                                    '</li></ul>';
                            } else {
                                var tbl = '<ul id="myUL_' + response.body[i].categoryId + '" data-field="1" class="level bg_white"><li id="li_' + response.body[i].categoryId + '"><span class="caret" value="0" id="spanA_' +
                                    response.body[i].categoryId +
                                    '" onclick=getRootLeafNodes("' +
                                    response.body[i].categoryId +
                                    '")></span> ' +
                                    '<div class="category"><input type="checkbox" id="cat_' +
                                    response.body[i].categoryId +
                                    '" class="pc1-box" value=' +
                                    response.body[i].categoryId +
                                    ' onchange=selectCheckBox("' +
                                    response.body[i].categoryId +
                                    '","' +
                                    response.body[i].catLevel +
                                    '")></div><span id="lbl_' + response.body[i].categoryId + '" class="leveltxt" level="' + response.body[i].catLevel + '">' +
                                    response.body[i].categoryName +
                                    '</span> ' +
                                    '<ul class="nested bg_white" id="ul_' + response.body[i].categoryId + '" data-field="0"></ul>' +
                                    '</li></ul>';
                            }

                            $("#productCategoryCBDiv").append(tbl);

                            getRootLeafNodes(response.body[i].categoryId);
                        }

                        var prCategoryId = $("#prodCatId").val();
                        $("#cat_" + prCategoryId).prop("checked", true);

                    }
                } else {
                    swal({
                        title: response.code,
                        text: response.message,
                        type: "warning"
                    })
                }
            },
            error: function(response) {
                console.log(response);
            }
        })
}

function getRootLeafNodes(id) {

    $("#ul_" + id).empty();

    var value = $("#spanA_" + id).attr("value");
    if (value == "0") {

        $
            .ajax({
                type: "POST",
                url: "view-requisition-product-category-get-category-list-by-id",
                dataType: "json",
                contentType: "application/json",
                data: id,
                success: function(response) {
                    if (response.message == "Success") {
                        if (response.body.length > 0) {
                            for (var i = 0; i < response.body.length; i++) {

                                if (response.body[i].nodeCount > 0) {
                                    var tbl = '<li id="li_' + response.body[i].categoryId + '"><span class="caret" value="0" id="span_' +
                                        response.body[i].categoryId +
                                        '" onclick=getLeafNodes("' +
                                        response.body[i].categoryId +
                                        '")></span><span class="leveltxt" id="lbl_' + response.body[i].categoryId + '" level="' + response.body[i].catLevel + '"> ' +
                                        response.body[i].categoryName +
                                        ' </span>' +
                                        '<ul class="nested bg_white" id="ul_' + response.body[i].categoryId + '" data-field="0"></ul>' +
                                        '</li>';
                                } else {
                                    var tbl = '<li id="li_' + response.body[i].categoryId + '"><span class="caret" value="0" id="span_' +
                                        response.body[i].categoryId +
                                        '" onclick=getLeafNodes("' +
                                        response.body[i].categoryId +
                                        '")></span><div class="category"><input type="checkbox" id="cat_' +
                                        response.body[i].categoryId +
                                        '" class="pc1-box" value=' +
                                        response.body[i].categoryId +
                                        '  onchange=selectCheckBox("' +
                                        response.body[i].categoryId +
                                        '","' +
                                        response.body[i].catLevel +
                                        '")></div><span class="leveltxt" id="lbl_' + response.body[i].categoryId + '" level="' + response.body[i].catLevel + '"> ' +
                                        response.body[i].categoryName +
                                        ' </span>' +
                                        '<ul class="nested bg_white" id="ul_' + response.body[i].categoryId + '" data-field="0"></ul>' +
                                        '</li>';
                                }

                                $("#spanA_" + id).attr("value", "1");
                                $("#spanA_" + id)
                                    .addClass("caret-down");
                                $("#ul_" + id).addClass("active");

                                $("#ul_" + id).append(tbl);

                                getLeafNodes(response.body[i].categoryId);
                            }

                            var prCategoryId = $("#prodCatId").val();

                            $("#cat_" + prCategoryId).prop("checked",
                                true);

                            //$("#ul_"+id).attr("data-field","1");
                        }
                    }

                },
                error: function(data) {
                    $("#spanA_" + id).attr("value", "0");
                    $("#spanA_" + id).removeClass("caret-down");
                    $("#ul_" + id).removeClass("active");
                    $("#ul_" + id).empty();
                }
            });
    } else {
        $("#spanA_" + id).attr("value", "0");
        $("#spanA_" + id).removeClass("caret-down");
        $("#ul_" + id).removeClass("active");
        $("#ul_" + id).empty();
    }
}

function getLeafNodes(id) {

    $("#ul_" + id).empty();

    var value = $("#span_" + id).attr("value");
    if (value == "0") {

        $
            .ajax({
                type: "POST",
                url: "view-requisition-product-category-get-category-list-by-id",
                dataType: "json",
                contentType: "application/json",
                data: id,
                success: function(response) {
                    if (response.message == "Success") {
                        if (response.body.length > 0) {
                            for (var i = 0; i < response.body.length; i++) {

                                if (response.body[i].nodeCount > 0) {
                                    var tbl = '<li id="li_' + response.body[i].categoryId + '"><span class="caret" value="0" id="span_' +
                                        response.body[i].categoryId +
                                        '" onclick=getLeafNodes("' +
                                        response.body[i].categoryId +
                                        '")></span><span class="leveltxt" id="lbl_' + response.body[i].categoryId + '" level="' + response.body[i].catLevel + '"> ' +
                                        response.body[i].categoryName +
                                        ' </span>' +
                                        '<ul class="nested bg_white" id="ul_' + response.body[i].categoryId + '" data-field="0"></ul>' +
                                        '</li>';
                                } else {
                                    var tbl = '<li id="li_' + response.body[i].categoryId + '"><span class="caret" value="0" id="span_' +
                                        response.body[i].categoryId +
                                        '" onclick=getLeafNodes("' +
                                        response.body[i].categoryId +
                                        '")></span><div class="category"><input type="checkbox" id="cat_' +
                                        response.body[i].categoryId +
                                        '" class="pc1-box" value=' +
                                        response.body[i].categoryId +
                                        '  onchange=selectCheckBox("' +
                                        response.body[i].categoryId +
                                        '","' +
                                        response.body[i].catLevel +
                                        '")></div><span class="leveltxt" id="lbl_' + response.body[i].categoryId + '" level="' + response.body[i].catLevel + '"> ' +
                                        response.body[i].categoryName +
                                        ' </span>' +
                                        '<ul class="nested bg_white" id="ul_' + response.body[i].categoryId + '" data-field="0"></ul>' +
                                        '</li>';
                                }

                                $("#span_" + id).attr("value", "1");
                                $("#span_" + id).addClass("caret-down");
                                $("#ul_" + id).addClass("active");
                                //var df = $("#ul_"+id).attr("data-field");
                                //if(df == 0) {
                                $("#ul_" + id).append(tbl);
                                //}
                                getLeafNodes(response.body[i].categoryId);
                            }

                            var prCategoryId = $("#prodCatId").val();
                            if (prCategoryId) {
                                $("#cat_" + prCategoryId).prop(
                                    "checked", true);
                                getProductByCategory();
                            }
                        }
                    }

                },
                error: function(data) {
                    $("#span_" + id).attr("value", "0");
                    $("#span_" + id).removeClass("caret-down");
                    $("#ul_" + id).removeClass("active");
                    $("#ul_" + id).empty();
                    $("#ul_" + id).empty();
                }
            });
    } else {
        $("#span_" + id).attr("value", "0");
        $("#span_" + id).removeClass("caret-down");
        $("#ul_" + id).removeClass("active");
        $("#ul_" + id).empty();
    }
}

function selectCheckBox(id, lvl) {
    $("#select_product").empty();
    getProductByCategory();

    /* $(".pc1-box").prop("checked",false);
    $("#cat_"+id).prop("checked",true); */

    if (lvl == 'L1') {
        var textDesc = $("#lbl_" + id).text();
        $("#catDesc").text(textDesc);
    } else {
        var res = lvl.substring(1, 1000000);

        var lastText = $("#lbl_" + id).text();
        var textDesc = "";
        for (i = res; i > 1; i--) {
            var pUL = $("#lbl_" + id).parents("ul").attr("id");
            pUL = pUL.substring(3, 10000000000000);
            var newText = $("#lbl_" + pUL).text();
            textDesc = newText + " > " + textDesc;
            id = pUL;
        }
        textDesc = textDesc + lastText;
        $("#catDesc").text(textDesc);
    }
}

function getProductByCategory() {
    $("#select_product").empty();
    var valor = "";
    $('input.pc1-box[type=checkbox]').each(function() {
        if (this.checked)
            valor = valor + $(this).val() + ",";
    });
    console.log(valor)
    if (valor) {
        $("#select_product").empty();
        $.ajax({
            type: "POST",
            url: "view-requisition-get-product-by-cat",
            dataType: 'json',
            contentType: 'application/json',
            data: valor,
            success: function(response) {
                if (response.message == "success") {
                    console.log(response.body)
                    $("#select_product").empty();
                    var content = '';
                    for (var i = 0; i < response.body.length; i++) {

                        content += '<div class="autocompletedata cp product-item" id="' +
                            response.body[i].productId +
                            "_" +
                            response.body[i].sku +
                            '" onClick=selectActive("' +
                            response.body[i].productId +
                            "_" +
                            response.body[i].sku +
                            '","' +
                            response.body[i].sku +
                            '","' +
                            response.body[i].productId +
                            '","' +
                            encodeURIComponent(response.body[i].productName) +
                            '","' +
                            response.body[i].brandId +
                            '","' +
                            response.body[i].brandName +
                            '","' +
                            response.body[i].productCatId +
                            '","' +
                            response.body[i].productCatName +
                            '")>' +
                            response.body[i].sku +
                            " - " +
                            response.body[i].brandName +
                            " - " +
                            response.body[i].productName +
                            '</div>';
                    }
                    content += '</ul>';
                    $("#select_product").show();
                    $("#select_product").append(content);

                    var itemId = $("#itemId").val();
                    var skuId = $("#sku").html();

                    if (itemId) {
                        $("#" + itemId + "_" + skuId).addClass(
                            'productActive');
                    }

                }
            },
            error: function(data) {

            }
        })
    } else {
        $("#select_product").empty();
    }
}

function selectActive(id, sku, productId, productName, brandId, brandName,
    prodCatId, prodCatName) {
    var splitArray = productName.split('%20');
    var finalString = "";
    for (i = 0; i < splitArray.length; i++) {
        finalString += splitArray[i] + " ";
    }
    $('.autocompletedata ').removeClass('productActive');
    $("#" + id).addClass('productActive');
    $("#itemNameTemp").val(finalString);
    $("#itemIdTemp").val(productId);
    $("#brandNameTemp").val(brandName);
    $("#brandIdTemp").val(brandId);
    $("#skuTemp").val(sku);
    $("#prodCatIdTemp").val(prodCatId);
    $("#prodCatNameTemp").val(prodCatName);
    $("#searchTemp").val(productName)

}

function selectProductVal() {
    $("#itemName").html($("#itemNameTemp").val());
    $("#itemId").val($("#itemIdTemp").val());
    $("#brandName").html($("#brandNameTemp").val());
    $("#brandId").val($("#brandIdTemp").val());
    $("#prodCatId").val($("#prodCatIdTemp").val());
    $("#prodCatName").val($("#prodCatNameTemp").val());
    $("#sku").html($("#skuTemp").val());
    $("#search").val($("#itemNameTemp").val())
    $("#select_product").html('');
    $('#myModal').modal('hide');
}

function validFormData() {
    var allValid = true;
    if (!validationUpdated("Description can't be Left Blank", 'desc'))
        allValid = false;
    if (!validationUpdated("Requisition Type can't be Left Blank",
            'reqType'))
        allValid = false;
    if (!validationUpdated("Requisition Priority can't be Left Blank",
            'reqPrior'))
        allValid = false;
    if (!validationUpdated("Receive Date can't be Left Blank",
            'receiveDate'))
        allValid = false;
    return allValid;
}

function validSideBarData() {
    var allValid = true;
    if (!validationUpdated("Item can't be Left Blank", 'itemId'))
        allValid = false;
    if (!validationUpdated("Location can't be Left Blank", 'locationId'))
        allValid = false;
    if (!validationUpdated("Cost Center can't be Left Blank",
            'costCenterId'))
        allValid = false;
    if (!validationUpdated("Location can't be Left Blank", 'locationId'))
        allValid = false;
    if (!validationUpdated("Quantity can't be Left Blank", 'quantity'))
        allValid = false;
    if (!validationUpdated("UOM can't be Left Blank", 'uom'))
        allValid = false;
    if (!validationUpdated("Estimated Price can't be Left Blank",
            'estimatedPrice'))
        allValid = false;
    if (!validationUpdated("Total Estimated Price can't be Left Blank",
            'totalEstPrc'))
        allValid = false;
    if (!validationUpdated("Last Unit Purchase Price can't be Left Blank",
            'lastPurchaseUnitPrice'))
        allValid = false;
    if (!validationUpdated("Last Total Purchase Price can't be Left Blank",
            'lastPurchaseTotalPrice'))
        allValid = false;

    return allValid;

}

function validProductData() {
    /* var item = null;
    productOptions.api.forEachNode(function(rowNode, index) {
    	item = item + rowNode.data;
    });
    if (item) {
    	return true;
    } else {
    	$("#messageParagraph").text("Please Add At Least One Product");
    	$("#msgOkModal").removeClass("btn3");
    	$("#msgOkModal").addClass("btn1");
    	$("#msgModal").modal('show');
    	return false;
    } */
    return true;
}

// for csv requisition
function requisitionCSV() {
    var dataset = [];
    gridOptions.api.forEachNodeAfterFilterAndSort(function(rowNode, index) {
        dataset.push(rowNode.data);
    });
    gridOptions.api.exportDataAsCsv(dataset);
}
	
$(document).ready(function(){
	$("#createProduct").click(function(){
		
		$(".benefitChk").prop("checked",false);
		$("#productModName").val("");
		$("#brand").val("");
		$("#skuMod").val("");
    	$("#modelMod").val("");
    	$("#manufactureItemMod").val("");
    	$("#variationTypeMod").val("");
    	$("#variationValueMod").val("");
    	$("#unitMod").val("");
		
		$('.loader').show();
    	$("body").addClass("overlay");
    	$("#productDiv").modal("show");
		$.ajax({
	        type: "POST",
	        url: "view-requisition-get-product-cat-list",
	        dataType: "json",
	        contentType: "application/json",
	        data: "a",
	        success: function(response) {
	        	if (response.message == "success") {
	            	for(var i = 0; i < response.body.length; i++) {
	            		var row = "";
	            		if(response.body[i].categoryId == response.body[i].parentId) {
	            			if(response.body[i].nodeCount > 0) {
	            				row = '<tr data-node-id="'+response.body[i].categoryId+'" class="abc" id="'+response.body[i].categoryId+'">'+
	    						'<td class="firstnode" id=lbl_'+response.body[i].categoryId+'>'+response.body[i].categoryName+'</td></tr>';
	            			} else {
	            				row = '<tr data-node-id="'+response.body[i].categoryId+'" class="abc" id="'+response.body[i].categoryId+'">'+
	    						'<td class="firstnode" id=lbl_'+response.body[i].categoryId+'><input class="benefitChk" type="checkbox" id="ccCheck_'+ response.body[i].categoryId +'" value="'+ response.body[i].categoryId +
	    						'" name="'+ response.body[i].categoryName +'" onchange=selectCheckBox1("'+response.body[i].categoryId+'","'+response.body[i].catLevel+'")>'+response.body[i].categoryName+'</td></tr>';
	            			}
	            			
	            		} else {
	            			if(response.body[i].nodeCount > 0) {
	            				row = '<tr data-node-id="'+response.body[i].categoryId+'" data-node-pid="'+response.body[i].parentId+'" class="abc" id="'+response.body[i].categoryId+'">'+
	    						'<td class="firstnode" id=lbl_'+response.body[i].categoryId+'>'+response.body[i].categoryName+'</td></tr>';
	            			} else {
	            				
	            					row = '<tr data-node-id="'+response.body[i].categoryId+'" data-node-pid="'+response.body[i].parentId+'" class="abc" id="'+response.body[i].categoryId+'">'+
	        						'<td class="firstnode" id=lbl_'+response.body[i].categoryId+'><input class="benefitChk" type="checkbox" id="ccCheck_'+ response.body[i].categoryId +'" value="'+ response.body[i].categoryId +'" name="'+
	        						response.body[i].categoryName +'" onchange=selectCheckBox1("'+response.body[i].categoryId+'","'+response.body[i].catLevel+'")>'+response.body[i].categoryName+'</td></tr>';
	            			}
	            		}
						$("#costCeneterCBDiv").append(row);
						
	            	}
	            	
	            	$('.loader').hide();
	            	$("body").removeClass("overlay");
	            	
	            	$('#basic').simpleTreeTable({
	            	    expander: $('#expander'),
	            	    collapser: $('#collapser'),
	            	    store: 'session',
	            		storeKey: 'simple-tree-table-basic'
	            	});
	            }
	        }, error: function(data) {
	        	console.log(data)
	        	$('.loader').hide();
	        	$("body").removeClass("overlay");
	        	$("#productDiv").modal("show");
	        }
		});
	})
	
	$("#saveProduct").click(function(){
		obj = {};
		
		obj.productName = $("#productModName").val();
		obj.brand = $("#brand").val();
		obj.productCategory = $(".benefitChk:checkbox:checked").val();
		obj.productCategoryText = $("#productCatId").val();
		obj.skuId = $("#skuMod").val();
    	obj.model = $("#modelMod").val();
    	obj.manufacture = $("#manufactureItemMod").val();
    	obj.variationType = $("#variationTypeMod").val();
    	obj.variationValue = $("#variationValueMod").val();
    	obj.unit = $("#unitMod").val();
    	var id = $(".benefitChk:checkbox:checked").val();
    	obj.hsnCode = $("#lbl_"+id).text();
    	
    	$(".formValidation").remove();
		allModValid = true;
		if( obj.productName == null || obj.productName == ""){
			allModValid = false;
			validationModal("Product Name Required","productModName");
		} 
		if( obj.brand == null || obj.brand == ""){
			allModValid = false;
			validationModal("Brand Required","brand");
		} 
		if( obj.skuId == null || obj.skuId == ""){
			allModValid = false;
			validationModal("SKU Required","skuMod");
		} 
		if( obj.model == null || obj.model == ""){
			allModValid = false;
			validationModal("Model Required","modelMod");
		} 
		if( obj.manufacture == null || obj.manufacture == ""){
			allModValid = false;
			validationModal("Manufacture Item No Required","manufactureItemMod");
		} 
		if( obj.variationType == null || obj.variationType == ""){
			allModValid = false;
			validationModal("Variation Type Required","variationTypeMod");
		} 
		if( obj.variationValue == null || obj.variationValue == ""){
			allModValid = false;
			validationModal("Variation Value Required","variationValueMod");
		} 
		if( obj.unit == null || obj.unit == ""){
			allModValid = false;
			validationModal("UOM Required","unitMod");
		} 
		if( obj.productCategory == null || obj.productCategory == ""){
			allModValid = false;
			$("#messageParagraph").text("Please Select Product Category");
        	$("#msgOkModal").addClass("btn3");
        	$("#msgOkModal").removeClass("btn1");
        	$("#msgModal").modal('show');
		} 
    	
		if(allModValid) {
			$('.loader').show();
           	$("body").addClass("overlay");
			submitOneProduct(obj)
		}
	})
})

function submitOneProduct(dataset) {
	$.ajax({
   	 type: "POST",
        url: "view-requisition-product-save",
        dataType: 'json',
        contentType: 'application/json',
        data: JSON.stringify(dataset),
       success: function(response) {
           if (response.message == "Success") {
	           	$('.loader').hide();
	           	$("body").removeClass("overlay");
	           	$("#messageParagraph").text("Data Saved Successfully");
	           	$("#msgOkModal").removeClass("btn3");
	           	$("#msgOkModal").addClass("btn1");
	           	$("#msgModal").modal('show');
	           	
	           	$("#productDiv").modal('hide');
	           	
	           	$("#search").val(response.body.productName);
	           	$("#itemName").text(response.body.productName);
	           	$("#sku").text(response.body.skuId);
	           	$("#brandName").text(response.body.mode);
	           	$("#brandId").val(response.body.brand);
	           	$("#prodCatId").val(response.body.productCategory);
	           	$("#prodCatName").val(response.body.hsnCode);
	           	$("#itemId").val(response.body.productId);
	           	$("#uom").val(response.body.unit);
	           	$("#search").attr("data-procat",response.body.productId);
           } else {
	           $('.loader').hide();
	           $("body").removeClass("overlay");
           }
       },
       error: function(response) {
       	$('.loader').hide();
       	$("body").removeClass("overlay");
           console.log(response);
       }
   }) 
}

function selectCheckBox1(id,lvl) {
	$(".benefitChk").prop("checked",false);
	$("#ccCheck_"+id).prop("checked",true);
	
	if(id && lvl) {
		if(lvl == 'L1') {
			var textDesc = $("#lbl_"+id).text();
			$("#productCatId").val(textDesc);
		} else {
			var res = lvl.substring(1, 1000000);
			
			var lastText = $("#lbl_"+id).text();
			var textDesc = "";
			for(i = res; i > 1; i--) {
				var pUL = $("#"+id).attr("data-node-pid");
				//pUL = pUL.substring(3, 10000000000000);
				var newText = $("#lbl_"+pUL).text();
				console.log(newText+" "+i)
				textDesc =  newText+" > "+textDesc ; 
				id = pUL;
			}
			textDesc = textDesc + lastText;
			$("#productCatId").val(textDesc);
		}
	}
}

function productExistMethod() {
	closeNav();
	var value = $("input[name='isProductExist']:checked").val();
	if(value == "1") {
		$("#dltProduct").attr("disabled",true);
		$("#addProduct").attr("disabled",true);
		$("#purchaseHistoryBtn").attr("disabled",true);
		$("#stockHistoryBtn").attr("disabled",true);
		$("#dwBtn").attr("disabled",true);
		$("#createRfq").attr("disabled",true);
		var dataset = [];
		productOptions.api.setRowData(dataset);
	} else {
		$("#dltProduct").attr("disabled",false);
		$("#addProduct").attr("disabled",false);
		$("#purchaseHistoryBtn").attr("disabled",false);
		$("#stockHistoryBtn").attr("disabled",false);
		$("#dwBtn").attr("disabled",false);
		$("#createRfq").attr("disabled",false);
	}
}
</script>
</head>
<body>

	<div layout:fragment="content" class="maincontent">

		<div class="container-fluid">
			<div class="row">
				<div class="maincontentsec">
					<div class="content_padding">
						<div class="row margin_topbot">
							<div class="btn-hs">
								<div class="input-style row">
									<input type="text" placeholder="Search.." name="search"
										class="searchboxinput" onkeyup="cancelBar()"
										oninput="onQuickFilterChanged()" id="quickFilter">
									<div class="searchicon">
										<a href="javascript:void(0)"><span style="display: none" id="closeKey"
											onclick="gridOptions.api.setQuickFilter(null);$('#quickFilter').val('');document.getElementById('closeKey').style.display='none';"
											class="close_i">X</span></a><a href="javascript:void(0)"><i
											class="fa fa-search"></i></a>
									</div>
								</div>
							</div>
						</div>
						<div class="row" id="reqTable">

							<div class="col-md-4 btn-hs">
								<div class="font-design" id="totalReq">
									REQUISITION LIST (<span></span>)
								</div>
							</div>
							<div class="col-md-8 buttonsec btn-hs">

								<button class="btn4" onclick="requisitionCSV()">DOWNLOAD</button>
								<button class="btn4">UPLOAD</button>
								<div class="buttongap"></div>
								<button id="reqAppvBtn" class="btn2" onclick="approve()">APPROVE</button>
								<div class="buttongap"></div>
								<button class="btn3" id="reqDltBtn" onclick="deleteFun()">DELETE</button>
								<button class="btn2" id="reqCopyBtn" onclick="copy()">COPY</button>
								<button class="btn1" id="newBtn" onclick="switchPage()">NEW</button>
								
							</div>

						</div>
						<div id="myGrid" style="width: 100%; height: 500px;"
							class="ag-theme-alpine"></div>

						<div class="collapse" id="demo">
							<div class="innerstickybg">
								<div class="row">

									<div class="col-md-3">
										Requisition ID: <span id="reqHeadId"></span>
									</div>
									<div class="col-md-6">
										<div id="statusDiv">
											<div class="hr4"></div>
											<div class="main-div">
												<div class="section2">
													<div id="createdDiv" class="green-box">
														<div class="green-box-heading">CREATED</div>
														<div class="date" id="createdDate"></div>
													</div>
												</div>
												<div class="section3">
													<div id="activeDiv" class="green-box">
														<div class="green-box-heading">ACTIVE</div>
														<div class="date" id="activeDate"></div>
													</div>
												</div>
												<div class="section4">
													<div id="completeDiv" class="grey-box">
														<div class="green-box-heading">COMPLETE</div>
														<div class="date" id="completeDate"></div>
													</div>
												</div>
												<div class="section5">
													<div id="onHoldDiv" class="grey-box">
														<div class="green-box-heading">ONHOLD</div>
														<div class="date" id="onHoldDate"></div>
													</div>
												</div>

											</div>
										</div>
									</div>
									<div class="col-md-3" align="right">
										<button class="btn4" id="cancelBtn">Cancel</button>
										<button class="btn1" id="saveReq" onclick="saveData()">Save</button>
									</div>
								</div>

							</div>
							<div class="row innersticky_contentgap">
								<div class="col-md-6">
									<div class="form-group">
										<label>Description</label>
										<textarea id="desc" class="bigtxtarea"
											onkeyup="textCount(event)" onblur="removeValid(event)"></textarea>
										<div id="charNumSN" class="txtcounter" align="right">
											<span>0</span> characters
										</div>
										<input type="hidden" id="reqId" />
									</div>
									<div class="form-group">
										<input type="checkbox" class="loc-chb" name="isProductExist"
											id="isProductExist" value="1" onchange="productExistMethod();"> <label
											class="checkboxlbltxt">Product Not Exist</label>
									</div>
								</div>
								<div class="col-md-6">
									<div class="row">
										<div class="col-md-6">
											<div class="form-group">
												<label>Type</label>
												<div class="select">
													<select id="reqType" onblur="removeValid(event)">
														<option th:value=null>--Select--</option>
														<option th:each="c:${requisitionTypeList}"
															th:value='${c.key}' th:text="${c.name}"
															th:selected="${c.key==employeeEmployment}"></option>
													</select>
												</div>
											</div>
										</div>

										<div class="col-md-6">
											<div class="form-group">
												<label>Priority</label>
												<div class="select">
													<select id="reqPrior" onblur="removeValid(event)">
														<option th:value=null>--Select--</option>
														<option th:each="c:${requisitionPrioList}"
															th:value='${c.key}' th:text="${c.name}"
															th:selected="${c.key==employeeEmployment}"></option>
													</select>
												</div>
											</div>
										</div>

									</div>
									<div class="row">
										<div class="col-md-6">
											<div class="form-group">
												<label>Receive By Date</label> <input type="text"
													id="receiveDate" class="form-control" onblur="removeValid(event)"
													th:attr="onkeyup=|formatDate('receiveDate','${session.DATEFORMAT_JS}')|">
												<i class="ti-calendar picker_calendar"
													id="receiveDateCalendar"></i>
											</div>
										</div>

										<div class="col-md-6">
											<div class="form-group">
												<button class="btn2 putonhold" id="putOnHold"
													onclick="putOnHold()">PUT ON HOLD</button>
												<input type="hidden" value="1" id="isHold" />
											</div>
										</div>
									</div>
								</div>
							</div>
							<div id="main_content">
								<div class="wrapper center-block">
									<div class="panel-group" id="accordion" role="tablist"
										aria-multiselectable="true">
										<div class="panel panel-default">
											<div class="panel-heading active" role="tab" id="headingOne">
												<h4 class="panel-title">
													<a role="button" data-toggle="collapse"
														data-parent="#accordion" href="#itemList"
														aria-expanded="true" aria-controls="itemList"> Item
														List </a>
												</h4>
											</div>
											<div id="itemList" class="panel-collapse collapse show"
												role="tabpanel" aria-labelledby="headingOne">
												<div class="row">

													<div class="col-md-4 btn-hs1">
														<div class="font-design"></div>
													</div>
													<div class="col-md-8 butttonsec">
														<button class="btn4" id="dwBtn">Download</button>
														<div class="buttongap"></div>
														<button class="btn2 btn_extend" id="purchaseHistoryBtn">Purchase History</button>
														<button class="btn2 btn_extend" onclick="stockReport()" id="stockHistoryBtn">Stock
															History</button>
														<div class="buttongap"></div>
														<button class="btn3" id="dltProduct"
															onclick="deleteProduct()">DELETE</button>
														<button class="btn1" id="addProduct" onclick="openNav()">NEW</button>
													</div>






												</div>
												<div id="product" style="width: 100%; height: 200px;"
													class="ag-theme-alpine"></div>


											</div>



										</div>

										<div class="panel panel-default">
											<div class="panel-heading active" role="tab" id="headingtwo">
												<h4 class="panel-title">
													<a role="button" data-toggle="collapse"
														data-parent="#accordion" href="#activityone"
														aria-expanded="true" aria-controls="itemList">
														Activities </a>
												</h4>
											</div>
											<div id="activityone" class="panel-collapse collapse show"
												role="tabpanel" aria-labelledby="headingtwo">
												<div class="row">

													<div class="col-md-6 btn-hs1">
														<div class="font-design"></div>
													</div>

													<div class="col-md-6 buttonsec btn-hs1">

														<button class="btn4">Download</button>
														<button class="btn4">Upload</button>
														<div class="buttongap"></div>
														<button class="btn2" id="createRfq" onclick="viewRFQ()">Create
															RFQ</button>
													</div>

												</div>
												<div id="activity" style="width: 100%; height: 200px;"
													class="ag-theme-alpine"></div>


											</div>
										</div>
									</div>


									<div id="mySidenav" class="sidenav">
										<div class="slidebox">
											<div class="row">
												<div class="col-md-9">
													<div class="edit">
														SKU: <span id="skuEditId"></span>
													</div>
												</div>
												<div class="col-md-3">
													<div class="arrow">
														<a href="javascript:void(0)" class="closebtn"
															onclick="closeNav()"><i class="ti-arrow-right"></i></a>
													</div>
												</div>
											</div>
											<div class="chartbtnsec">
												<div align="right">
													<button class="btn4" onclick="closeNav()">CANCEL</button>
													<button class="btn1" onclick="saveTableData()">SAVE</button>
													<button class="btn2" id="createProduct">CREATE PRODUCT</button>
												</div>
											</div>
											<div class="clearfix"></div>
											<div class="row">
												<div class="col-lg-9">
													<div class="form-group">

														<div class="inner_search">

															<div class="input-style1 row">
																<div class="autocomplete">
																	<input id="search" type="text" name="search"
																		class="inner_searchboxinput" placeholder="Search"
																		onkeyup='getProductList()'>
																</div>

																<div class="searchicon1">
																	<a href="javascript:void(0)"><span
																		style="display: block; border-right: 1px solid rgb(204, 204, 204); padding-right: 5px;"
																		id="closeKey" onclick="clearSearchData()"
																		class="close_i"><i class="ti-close srchicon"></i></span></a><a
																		href="javascript:void(0)" style="color: #ccc; margin-top: -5px;"><i
																		class="ti-search srchicon"></i></a>

																</div>

															</div>
														</div>

														<div id="suggesstion-box1_" class="sugg-cls"></div>
													</div>
												</div>
												<div class="col-lg-3 mrt_6">
													<div class="form-group">
														<button id="browseBtn" class="btn2">Browse</button>
													</div>
												</div>
											</div>

											<div class="row">
												<div class="col-lg-6">
													<div class="form-group">
														<label>SKU</label> &nbsp; &nbsp; <span id="sku"
															class="fetchdata"></span>
													</div>
												</div>
												<div class="col-lg-6">
													<div class="form-group">
														<label>Brand</label><input type="hidden" id="brandId" /><input
															type="hidden" id="prodCatId" /> <input type="hidden"
															id="prodCatName" /><span id="brandName"
															class="fetchdata"></span>
													</div>
												</div>
											</div>

											<div class="row">
												<div class="col-lg-8">
													<div class="form-group">
														<label>Item Name</label><span id="itemName"
															class="fetchdata"></span><input type="hidden" id="itemId">
														<input type="hidden" id="productEdit">

													</div>
												</div>

											</div>
											<div class="row">
												<div class="col-lg-6">
													<div class="form-group">
														<label>Location</label>
														<div class="select">
															<select id="locationId">
																<option th:value=null>--Select--</option>
																<option th:each="c:${locationList}" th:value='${c.key}'
																	th:text="${c.name}"></option>
															</select>
														</div>
													</div>
												</div>
												<div class="col-lg-6">
													<div class="form-group">
														<label>Cost Center</label>
														<div class="select">
															<select id="costCenterId">
																<option th:value=null>--Select--</option>
																<option th:each="c:${costCenterList}"
																	th:value='${c.key}' th:text="${c.name}"></option>
															</select>
														</div>
													</div>
												</div>
												<div class="col-lg-6">
													<div class="form-group">
														<label>Quantity</label> <input type="text"
															class="form-control transparenttxtbox" id="quantity" onblur="numberWithCommas(this.id)">
													</div>
												</div>
												<div class="col-lg-6">
													<div class="form-group">
														<label>UOM</label>
														<div class="select">
															<select id="uom">
																<option th:value=null>--Select--</option>
																<option th:each="c:${uomList}" th:value='${c.key}'
																	th:text="${c.name}"></option>
															</select>
														</div>

													</div>
												</div>
											</div>

											<div class="row">
												<div class="col-lg-6">
													<div class="form-group">
														<label>Estimated Price</label> <input type="text"
															class="form-control transparenttxtbox"
															id="estimatedPrice" onblur="numberWithCommas(this.id)">
													</div>
												</div>
												<div class="col-lg-6">
													<div class="form-group">
														<label>Estimated Total Price</label> <input type="text"
															class="form-control transparenttxtbox" id="totalEstPrc" onblur="numberWithCommas(this.id)">
													</div>
												</div>
											</div>
											<div class="row">
												<div class="col-lg-6">
													<div class="form-group">
														<label>Last Purchase unit Price</label> <input type="text"
															class="form-control transparenttxtbox"
															id="lastPurchaseUnitPrice" onblur="numberWithCommas(this.id)" >
													</div>
												</div>
												<div class="col-lg-6">
													<div class="form-group">
														<label>Last Purchase Total Price</label> <input
															type="text" class="form-control transparenttxtbox"
															id="lastPurchaseTotalPrice" onblur="numberWithCommas(this.id)">
													</div>
												</div>
											</div>

										</div>
									</div>
								</div>

							</div>
						</div>





					</div>
					<div class="modal fade" id="lineGraph">
						<div class="modal-dialog modal-lg">
							<div class="modal-content large-model">

								<div align="right">
									<button type="button" class="close" data-dismiss="modal">
										<i class="ti-close" style="font-size: 14px;"></i>
									</button>
								</div>
								<!-- Modal body -->
								<div class="modal-body">
									<div class="row" id="lineGraphDiv">
										<div class="col-md-12">
											<div id="chart" class="collapse show">
												<div style="width: 90%; height: 280px; margin: 0 auto;">
													<div id="container1" style="width: 100%; height: 280px;"></div>
												</div>
												<div style="width: 90%; height: auto; margin: 0 auto;">
													<div class="row">
														<div class="col-md-12">

															<div align="right" class="pdficonsec">
																<i class="fa fa-file-pdf-o fa-2x pdf"
																	onclick="downloadChartPdf()"></i> <i
																	class="fa fa-file-excel-o fa-2x excel"
																	onclick="getExcelReport()"></i>
															</div>
															<table id="graphTable" class="newtbl">
															</table>
														</div>

													</div>
												</div>
											</div>
										</div>
									</div>

								</div>
								<!-- Modal footer -->



							</div>
						</div>
					</div>
					<!-- delete modal start -->
					<div id="delete" class="modal fade show" aria-modal="true">
						<div class="modal-dialog modal-confirm">
							<div class="modal-content">
								<div class="modal-header flex-column">
									<button type="button" class="close" data-dismiss="modal"
										aria-hidden="true" onclick="cancelModalBtn()">
										<i class="ti-close modal-close"></i>
									</button>
								</div>
								<div class="modal-body">
									<p>Do you really want to delete these records? This process
										cannot be undone.</p>
								</div>
								<div class="modal-footer justify-content-center"
									style="margin-top: -30px;">

									<button type="button" class="btn4" data-dismiss="modal"
										onclick="cancelModalBtn();">Cancel</button>
									<button type="button" class="btn3" onclick="deleteOnclick()">Delete</button>
								</div>
							</div>
						</div>
					</div>

					<!-- delete product modal start -->
					<div id="deleteProduct" class="modal fade show" aria-modal="true">
						<div class="modal-dialog modal-confirm">
							<div class="modal-content">
								<div class="modal-header flex-column">
									<button type="button" class="close" data-dismiss="modal"
										aria-hidden="true" onclick="cancelModalProductBtn()">
										<i class="ti-close modal-close"></i>
									</button>
								</div>
								<div class="modal-body">
									<p>Do you really want to delete these records? This process
										cannot be undone.</p>
								</div>
								<div class="modal-footer justify-content-center"
									style="margin-top: -30px;">

									<button type="button" class="btn4" data-dismiss="modal"
										onclick="cancelModalBtn();">Cancel</button>
									<button type="button" class="btn3"
										onclick="deleteProductOnclick()">Delete</button>
								</div>
							</div>
						</div>
					</div>


					<!-- delete product modal start -->
					<div id="deleteProductInd" class="modal fade show"
						aria-modal="true">
						<div class="modal-dialog modal-confirm">
							<div class="modal-content">
								<div class="modal-header flex-column">
									<button type="button" class="close" data-dismiss="modal"
										aria-hidden="true" onclick="cancelModalProductBtn()">
										<i class="ti-close modal-close"></i>
									</button>
								</div>
								<div class="modal-body">
									<p>Do you really want to delete these records? This process
										cannot be undone.</p>
								</div>
								<div class="modal-footer justify-content-center"
									style="margin-top: -30px;">

									<button type="button" class="btn4" data-dismiss="modal"
										onclick="cancelModalBtn();">Cancel</button>
									<button type="button" class="btn3" onclick="deleteProductInd()">Delete</button>
								</div>
							</div>
						</div>
					</div>

					<div class="modal fade" id="myModal">
						<div class="modal-dialog modal-lg" style="margin-top: 130px;">
							<div class="modal-content">

								<!-- Modal Header -->
								<div class="modal-header">
									<h4 class="modal-title md-color">Select Product</h4>
									<button type="button" class="close cp" data-dismiss="modal">&times;</button>
								</div>

								<!-- Modal body -->
								<div class="modal-body modal-cat">
									<div class="row">

										<div class="col-md-6" df="0">
											<div style="height: 300px; overflow-y: scroll;"
												id="productCategoryCBDiv"></div>
										</div>
										<div class="col-md-6" id="productCategorySelectDiv" df="0"
											style="border-left: 1px solid #ccc;">
											<div style="height: 300px; overflow-y: scroll;">
												<div class="productlist">Select Product</div>
												<div id="select_product"></div>
												<input type="hidden" id="itemNameTemp" /> <input
													type="hidden" id="itemIdTemp" /> <input type="hidden"
													id="brandNameTemp" /> <input type="hidden"
													id="brandIdTemp" /> <input type="hidden" id="skuTemp" />
												<input type="hidden" id="prodCatIdTemp" /> <input
													type="hidden" id="prodCatNameTemp" />
											</div>
										</div>
									</div>
								</div>

								<!-- Modal footer -->
								<div class="modal-footer">
									<div class="chartbtnsec">
										<button class="btn2" onclick="selectProductVal()">SELECT</button>
										<button class="btn4" data-dismiss="modal">CANCEL</button>
									</div>
								</div>

							</div>
						</div>
					</div>


					<!-- alert modal start -->
					<div id="alert" class="modal fade show" aria-modal="true">
						<div class="modal-dialog modal-confirm">
							<div class="modal-content">
								<div class="modal-header flex-column">
									<button type="button" class="close" data-dismiss="modal"
										aria-hidden="true" onclick="cancelModalBtn()">
										<i class="ti-close modal-close"></i>
									</button>
								</div>
								<div class="modal-body">
									<p id="textId"></p>
								</div>
								<div class="modal-footer justify-content-center"
									style="margin-top: -30px;">

									<button type="button" class="btn1" data-dismiss="modal">SELECT</button>
									<!-- <button type="button" class="btn3" onclick="deleteOnclick()">Delete</button> -->
								</div>
							</div>
						</div>
					</div>
					
					<div class="modal fade" id="productDiv">
						<div class="modal-dialog modal-xl" style="margin-top: 50px;">
							<div class="modal-content">
			
								<!-- Modal Header -->
								<div class="modal-header">
									<h4 class="modal-title md-color"></h4>
									<button type="button" class="close cp" 
										data-dismiss="modal">&times;</button>
								</div>
			
								<!-- Modal body -->
								<div class="modal-body modal-pcat">
									<div class="row">
										<div class="col-md-6" style="border-right: 1px solid #929292">
											<h4 class="modal-title md-color mrb_15">Select Product Category</h4>
											<div style="overflow-y: scroll;height: 380px;">
												<table 
													id="basic">
													<tbody id="costCeneterCBDiv"></tbody></table>
											</div>
										</div>
										<div class="col-md-6">
											<h4 class="modal-title md-color mrb_15">Enter Product Details</h4>
											<div class="row">
												<div class="col-md-12 mrb_15">
													<input type="hidden" id="productCatId"> <input
														type="text" name="code" value="" id="productModName"
														placeholder="Product Name" class="form-control textbig"
														onblur="removeValid(event);">
												</div>
												<div class="col-md-6">
													<div class="form-group">
														<label>Brand</label>
														<div class="select">
															<select class="" id="brand" onblur="removeValid(event);">
																<option value="">Select</option>
																<option th:each="c,iter:${brandList}"
																	th:value="${c.key}" th:text="${c.name}"></option>
															</select>
														</div>
													</div>
												</div>
												<div class="col-md-6">
													<div class="form-group">
														<label>SKU</label> <input type="text" name="code" value=""
															id="skuMod" placeholder="" class="form-control"
															onblur="removeValid(event);">
													</div>
												</div>
												<div class="col-md-6">
													<div class="form-group">
														<label>Model</label> <input type="text" name="code"
															value="" id="modelMod" placeholder=""
															class="form-control" onblur="removeValid(event);">
													</div>
												</div>
												<div class="col-md-6">
													<div class="form-group">
														<label>Manufacture Item</label> <input type="text"
															name="code" value="" id="manufactureItemMod"
															placeholder="" class="form-control"
															onblur="removeValid(event);">
													</div>
												</div>
												<div class="col-md-6">
													<div class="form-group">
														<label>Variation Type</label>
														<div class="select">
															<select class="" id="variationTypeMod"
																onblur="removeValid(event);">
																<option value="">Select</option>
																<option th:each="c,iter:${variationTypeList}"
																	th:value="${c.key}" th:text="${c.name}"></option>
															</select>
														</div>
													</div>
												</div>
												<div class="col-md-6">
													<div class="form-group">
														<label>Variation Value</label> <input type="text" value=""
															onblur="removeValid(event);" placeholder=""
															class="form-control" id="variationValueMod">
													</div>
												</div>
												<div class="col-md-6">
													<div class="form-group">
														<label>UOM</label>
														<div class="select">
															<select class="" id="unitMod" onblur="removeValid(event);">
																<option value="">Select</option>
																<option th:each="c,iter:${uomList}" th:value="${c.key}"
																	th:text="${c.name}"></option>
															</select>
														</div>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
			
								<!-- Modal footer -->
								<div class="modal-footer">
									<button class="btn4" data-dismiss="modal">Cancel</button>
									<button class="btn1" id="saveProduct">Save</button>
								</div>
			
							</div>
						</div>
					</div>

				</div>
			</div>
		</div>
	</div>
</body>
</html>